<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
    </head>
    <body>
        <div>
            <h1> DataWeb Wizard </h1>
            <h3> Log in </h3>
            <script>
                function checkComplete(method, target, msg){
                    var user = document.getElementById("uName").value;
                    var pwd = document.getElementById("pwd").value;
                    if(user != "" && pwd != ""){
                        //vamos a llamar al famoso servicio rest
                        var ajaxRequest;
                        if (window.XMLHttpRequest){
                            ajaxRequest=new XMLHttpRequest(); // IE7+, Firefox, Chrome, Opera, Safari
                        } else {
                            ajaxRequest=new ActiveXObject("Microsoft.XMLHTTP"); // IE6, IE5
                        }
                        ajaxRequest.onreadystatechange = function(){
                            if (ajaxRequest.readyState==4 && (ajaxRequest.status==200 || ajaxRequest.status==204)){
                                console.log(ajaxRequest.responseText);
                                var respJSON = JSON.parse(ajaxRequest.responseText);
                                document.getElementById("name").value=respJSON.userName;
                                document.getElementById("db").value=respJSON.dbName;
                                //console.log("CARAJOOOOOOOOOOOOOOOOOOOO");
                                document.forms.continueLogIn.submit();
                               
                                
                            }
                        }
                        ajaxRequest.open(method, target, true /*async*/);
                        ajaxRequest.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"); 
                        ajaxRequest.send("userName="+user+"&password="+pwd);
                    }else{
                        alert("Ingrese todos los datos");
                    }
                }
            </script>
            
            <form>
                Usuario: <input id="uName" type="text" name="userName" value="" /> <br> <br>
                Contrase√±a: <input id="pwd" type="password" name="password" value="" /> <br> <br>
                <input type="submit" value="Log in" onclick="checkComplete('POST','http://localhost:8080/Omega/webresources/auth','')"/>
            </form>
            <br>
            <form id="continueLogIn" action="dataValidation.jsp" method="POST">
                <input id="name" type="hidden" name="user" value="" />
                <input id="db" type="hidden" name="db" value="" />
            </form>
            <a href="WEB-INF/NewUser.jsp">Crear nuevo usuario</a>
        </div>
    </body>
</html>
